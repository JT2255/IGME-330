(()=>{"use strict";var e,t,a,n,r,c,o,s,i,l=function(e,t){return Math.random()*(t-e)+e};!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var u=function(e){a.src=e},h=new Image;h.src="media/rocketship.png";var d,v,g,f,m,y,p,w,b=function(){function e(e,t,a,n,r,c){this.x=e,this.y=t,this.width=a,this.height=n,this.up=r,this.speed=1,this.scale=c}return e.prototype.update=function(){this.up?(this.y-=1*this.speed,this.y<-50&&(this.y=g+l(0,50),this.x=l(50,v-50),this.speed=l(1,2))):(this.y-=1*this.speed,this.y<-v-50&&(this.y=50-l(0,50),this.x=l(50,g-50),this.speed=l(1,2)))},e.prototype.draw=function(e){this.up?this.scale>1?(e.save(),e.drawImage(h,this.x-1,this.y,this.width*this.scale,this.height*this.scale),e.restore()):(e.save(),e.drawImage(h,this.x,this.y,this.width*this.scale,this.height*this.scale),e.restore()):this.scale>1?(e.save(),e.rotate(Math.PI/2),e.drawImage(h,this.x-1,this.y,this.width*this.scale,this.height*this.scale),e.restore()):(e.save(),e.rotate(Math.PI/2),e.drawImage(h,this.x,this.y,this.width*this.scale,this.height*this.scale),e.restore())},e}(),k=[],S=new Image;!function(e){e.sound1="media/Many Moons.mp3"}(w||(w={}));var q,T,A,F,M,I,C,R,V,x,B,G,P,N={showGradient:!0,showBars:!0,showCircles:!0,useWaveform:!0},z=20;M=document.querySelector("#cb-gradient"),I=document.querySelector("#cb-bars"),C=document.querySelector("#cb-circles"),R=document.querySelector("#cb-highshelf"),V=document.querySelector("#cb-lowshelf"),x=document.querySelector("#cb-distortion"),P=document.querySelector("#slider-distortion"),B=document.querySelector("#cb-rockets"),G=document.querySelector("#cb-waveform"),z=Number(P.value);var E=function(e){var n=document.querySelector("#btn-fs"),r=document.querySelector("#btn-play");n.onclick=function(t){var a;console.log("goFullscreen() called"),(a=e).requestFullscreen?a.requestFullscreen():a.mozRequestFullscreen?a.mozRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()},r.onclick=function(e){var n=e.target;"suspended"==t.state&&t.resume(),"no"==n.dataset.playing?(a.play(),n.dataset.playing="yes"):(a.pause(),n.dataset.playing="no")};var o=document.querySelector("#slider-volume"),s=document.querySelector("#label-volume");o.oninput=function(e){var t,a=e.target;t=Number(a.value),t=Number(t),c.gain.value=t,s.innerHTML=String(Math.round(Number(a.value)/2*100))},o.dispatchEvent(new Event("input")),document.querySelector("#select-track").onchange=function(e){var t=e.target;u(t.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))},M.onchange=function(e){e.target.checked?N.showGradient=!0:N.showGradient=!1},I.onchange=function(e){e.target.checked?N.showBars=!0:N.showBars=!1},C.onchange=function(e){e.target.checked?N.showCircles=!0:N.showCircles=!1},B.onchange=function(e){var t=e.target;F=!!t.checked},G.onchange=function(e){e.target.checked?N.useWaveform=!0:N.useWaveform=!1},R.onchange=function(e){var t=e.target;q=t.checked,H()},V.onchange=function(e){var t=e.target;T=t.checked,D()},x.onchange=function(e){var t=e.target;A=t.checked,L()},P.onchange=function(e){var t=e.target;z=Number(t.value),L()}},W=function(){if(setTimeout(W,1e3/60),function(e){if(e.useWaveform?m.getByteTimeDomainData(y):m.getByteFrequencyData(y),d.save(),d.fillStyle="black",d.globalAlpha=.1,d.fillRect(0,0,v,g),d.restore(),e.showGradient&&(d.save(),d.fillStyle=f,d.globalAlpha=.3,d.fillRect(0,0,v,g),d.restore()),e.showBars){p=0,d.fillStyle="rgba(255, 255, 255, 0.50)",d.strokeStyle="rgba(0, 0, 0, 0.50)",d.save(),d.translate(v/2+3,g/2-71);for(var t=0,a=y;t<a.length;t++){var n=a[t];(S=n/255)<.01&&(S=.01),p+=S,d.translate(4,0),d.rotate(2*Math.PI/32),d.save(),d.scale(1,-1),d.fillStyle="rgb(".concat(n,", ").concat(n,", ").concat(n,")"),d.fillRect(0,0,10,150*S),d.restore(),d.translate(10,0)}if(d.restore(),q)if(p>30)for(var r=0,c=k;r<c.length;r++)c[r].scale=1.1;else for(var o=0,s=k;o<s.length;o++)s[o].scale=1;else if(p>15)for(var i=0,l=k;i<l.length;i++)l[i].scale=1.1;else for(var u=0,h=k;u<h.length;u++)h[u].scale=1}if(e.showCircles){var w=g/4;d.save(),d.globalAlpha=.5;for(var b=0;b<y.length;b++){var S,T=(S=y[b]/255)*w;d.beginPath(),d.fillStyle=(255,255,void 0===(A=.02)&&(A=1),"rgba(".concat(255,",").concat(255,",").concat(255,",").concat(A,")")),d.arc(v/2,g/2,T,0,2*Math.PI,!1),d.fill(),d.closePath()}d.restore()}var A}(N),F)for(var e=0,t=k;e<t.length;e++){var a=t[e];a.update(),a.draw(d)}},H=function(){q?(o.frequency.setValueAtTime(1e3,t.currentTime),o.gain.setValueAtTime(15,t.currentTime)):o.gain.setValueAtTime(0,t.currentTime)},D=function(){T?(s.frequency.setValueAtTime(1e3,t.currentTime),s.gain.setValueAtTime(15,t.currentTime)):s.gain.setValueAtTime(0,t.currentTime)},L=function(){A?(i.curve=null,i.curve=O(z)):i.curve=null},O=function(e){void 0===e&&(e=20);for(var t=new Float32Array(256),a=0;a<256;++a){var n=2*a/256-1;t[a]=n*Math.sin(n)*e/5}return t},j=function(){var e=new XMLHttpRequest;e.onload=function(e){var t,a=e.target;console.log("In onload - HTTP Status Code = ".concat(a.status));try{t=JSON.parse(a.response)}catch(e){return void console.log("JSON file error")}for(var n=0,r=Object.keys(t);n<r.length;n++){var c=r[n];if("ui"==c)for(var o=0,s=t[c];o<s.length;o++){var i=s[o];switch(i.component){case"gradient":M.checked=i.value,N.showGradient=i.value;break;case"bars":I.checked=i.value,N.showBars=i.value;break;case"circles":C.checked=i.value,N.showCircles=i.value;break;case"highshelf":R.checked=i.value,q=i.value,H();break;case"lowshelf":V.checked=i.value,T=i.value,D();break;case"distortion":x.checked=i.value,A=i.value,L();break;case"rockets":B.checked=i.value,F=i.value;break;case"waveform":G.checked=i.value,N.useWaveform=i.value}}}},e.onerror=function(e){var t=e.target;console.log("In onerror - HTTP Status Code = ".concat(t.status))},e.open("GET","data/av-data.json"),e.send()};window.onload=function(){console.log("window.onload called"),function(){var h,p,q;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((h=function(){return l(35,220)})(),",").concat(h(),",").concat(h(),",1)"))),p=w.sound1,q=window.AudioContext,t=new q,a=new Audio,u(p),n=t.createMediaElementSource(a),(r=t.createAnalyser()).fftSize=e.numSamples,(c=t.createGain()).gain.value=e.gain,(o=t.createBiquadFilter()).type="highshelf",o.frequency.setValueAtTime(1e3,t.currentTime),o.gain.setValueAtTime(15,t.currentTime),(s=t.createBiquadFilter()).type="lowshelf",s.frequency.setValueAtTime(1e3,t.currentTime),s.gain.setValueAtTime(0,t.currentTime),i=t.createWaveShaper(),n.connect(o),o.connect(s),s.connect(r),r.connect(c),c.connect(i),i.connect(t.destination);var T=document.querySelector("canvas");E(T),function(e,t){d=e.getContext("2d"),v=e.width,g=e.height,f=function(e,t,a,n,r,c){for(var o=e.createLinearGradient(0,0,0,r),s=0,i=[{percent:0,color:"skyblue"},{percent:1,color:"lightpink"}];s<i.length;s++){var l=i[s];o.addColorStop(l.percent,l.color)}return o}(d,0,0,0,g),m=t,y=new Uint8Array(m.fftSize/2),k.push(new b(l(50,250),g+l(0,100),30,40,!0,1)),k.push(new b(l(500,750),g,30,40,!0,1)),k.push(new b(l(50,150),0+l(0,100),30,40,!1,1)),k.push(new b(l(400,550),0,30,40,!1,1)),S.src="./media/rocketship.png"}(T,r),j(),W()}()}})();
//# sourceMappingURL=bundle.js.map